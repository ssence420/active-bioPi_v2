Smart  Grow System ‚Äì QRH
========================================

Introduction
------------

This system is designed to automate and monitor a smart growing environment for a single  plant. It uses a tide-based hydroponic technique where the substrate is flooded once every 24 hours, then drained immediately.

The automation is handled by a Raspberry Pi 3, which interfaces with multiple sensors and actuators. Control and monitoring are available through a RESTful API. A web-based frontend enables interaction from any device on the same network. A 12" touchscreen connected to the Raspberry Pi can also run the local frontend in fullscreen mode.

The system is built for modularity and local-first operation, with optional expansion into remote access and cloud integration.

Key Features:
- Tide-based hydro system (1x daily flood and drain)
- Full environmental monitoring (temp, humidity, CO‚ÇÇ, pressure)
- Smart control of lighting, ventilation, and fluid systems
- Local CSV logging for all sensor and system data
- API-based architecture for full frontend/backend separation

Goals:
- Monitor and control all parameters through a web interface
- Log data locally to `/data/log.csv`
- Prepare for future cloud/database upgrades

Hardware Components
-------------------

The following components are used in this system:

1. **Controller**
   - Raspberry Pi 3 Model B

2. **Display**
   - 12‚Äù Touchscreen (used in fullscreen browser mode to run local frontend)

3. **Lighting System**
   - Sanlight 270W LED grow light
   - Gravity DFR0971 2-channel DAC (0‚Äì10V analog output for dimming via I¬≤C)
   - Relay module (power cutoff/on-off control for the LED)

4. **Air Circulation**
   - Inline ventilation fan with 5V PWM speed control

5. **Environmental Sensors**
   - 2 √ó BME280 sensors (temperature, humidity, pressure via I¬≤C)
   - 1 √ó MH-Z19 sensor (CO‚ÇÇ concentration via UART or PWM)

6. **Water & Nutrient System**
   - Tide-based hydro system with pump and valves
   - MS51 Nuvoton microcontroller:
     - Acts as I¬≤C slave interface
     - Provides ADC for pump/valve feedback or control

7. **I¬≤C Expansion**
   - Grove 8-Channel I¬≤C Multiplexer (TCA9548A)
     - Used to avoid address conflicts and extend available I¬≤C devices

8. **Power & Relays**
   - 5V, 12V, and 24V power rails as required by components
   - Relay modules for switching light and pump circuits
   - Logic-level shifters if needed (between Pi and microcontrollers/sensors)

9. **Enclosure & Wiring**
   - Custom enclosure or cabinet with structured cable routing
   - Heat-resistant, water-safe connectors for hydro area


Wiring Overview
---------------

üå± Growroom Automation ‚Äì Wiring Overview

üñ•Ô∏è Raspberry Pi GPIO Pinout (Used Pins)



  +-----+-----+---------+------+--- Pi 3 ---+------+---------+-----+-----+
  | Pin | BCM |  Name   | Dir  | Function   | Dir  |  Name   | BCM | Pin |
  +-----+-----+---------+------+------------+------+---------+-----+-----+
  |  1  | ‚Äî   | 3.3V    |  ‚Üí   | Power      |  ‚Üí   | 5V      | ‚Äî   |  2  |
  |  3  |  2  | SDA1    | I/O  | I¬≤C1 SDA   | I/O  | SCL1    |  3  |  5  |
  |  5  |  3  | SCL1    | I/O  | I¬≤C1 SCL   | I/O  | GND     | ‚Äî   |  6  |
  |  7  |  4  | GPIO4   | I/O  | GP Clock   | I/O  | TXD0    | 14  |  8  |
  |  9  | ‚Äî   | GND     |  ‚Üí   | Ground     |  ‚Üí   | RXD0    | 15  | 10  |
  | 11  | 17  | GPIO17  | I/O  | Gen Purpose| I/O  | GPIO18  | 18  | 12  |
  | 13  | 27  | GPIO27  | I/O  | Gen Purpose| I/O  | GND     | ‚Äî   | 14  |
  | 15  | 22  | GPIO22  | I/O  | Gen Purpose| I/O  | GPIO23  | 23  | 16  |
  | 17  | ‚Äî   | 3.3V    |  ‚Üí   | Power      |  ‚Üí   | GPIO24  | 24  | 18  |
  | 19  | 10  | MOSI    | I/O  | SPI        | I/O  | GND     | ‚Äî   | 20  |
  | 21  |  9  | MISO    | I/O  | SPI        | I/O  | SCLK    | 11  | 22  |
  | 23  | 11  | SCLK    | I/O  | SPI        | I/O  | GPIO25  | 25  | 24  |
  | 25  | ‚Äî   | GND     |  ‚Üí   | Ground     |  ‚Üí   | CE0     |  8  | 26  |
  | 27  |  0  | ID_SD   | I/O  | EEPROM ID  | I/O  | ID_SC   |  1  | 28  |
  | 29  |  5  | GPIO5   | I/O  | Gen Purpose| I/O  | GPIO6   |  6  | 30  |
  | 31  | 12  | GPIO12  | I/O  | PWM        | I/O  | GPIO13  | 13  | 32  |
  | 33  | 19  | GPIO19  | I/O  | PCM        | I/O  | GND     | ‚Äî   | 34  |
  | 35  | 16  | GPIO16  | I/O  | Gen Purpose| I/O  | GPIO26  | 26  | 36  |
  | 37  | 20  | GPIO20  | I/O  | PCM        | I/O  | GPIO21  | 21  | 38  |
  | 39  | ‚Äî   | GND     |  ‚Üí   | Ground     |  ‚Üí   | 5V      | ‚Äî   | 40  |
  +-----+-----+---------+------+------------+------+---------+-----+-----+







+--------+------------------------------+--------+------------------------------+--------+------------------------------+--------+------------------------------+
| Col 1  | Notes                        | Col 2  | Notes                        | Col 3  | Notes                        | Col 4  | Notes                        |
+--------+------------------------------+--------+------------------------------+--------+------------------------------+--------+------------------------------+
| +5V    |                              | +5V    |                              | +3V3   |                              | +3V3   |                              |
| GND    |                              | GND    |                              | GND    |                              | GND    |                              |
| SDA    | I2C data                     | IO23   | GPIO                         | TXD    | UART TX                      | IO17   | GPIO                         |
| SCL    | I2C clock                    | IO22   | GPIO                         | RXD    | UART RX                      | IO18   | GPIO                         |
| IO4    | GPIO                         | IDSD   | ID EEPROM data               | IO24   | GPIO                         | MOSI   | SPI                          |
| IO27   | GPIO                         | IDSC   | ID EEPROM clock              | IO25   | GPIO                         | MISO   | SPI                          |
| IO21   | GPIO                         | IO12   | GPIO                         | IO5    | GPIO                         | SCLK   | SPI clock                    |
| IO13   | GPIO                         | IO20   | GPIO                         | IO6    | GPIO                         | CE0    | SPI chip enable 0           |
| IO26   | GPIO                         | IO19   | GPIO                         | IO16   | GPIO                         | CE1    | SPI chip enable 1           |
| GND    |                              | GND    |                              | GND    |                              | GND    |                              |
+--------+------------------------------+--------+------------------------------+--------+------------------------------+--------+------------------------------+

| Function             | Pi Pin | BCM | Notes                              |
|----------------------|--------|-----|-------------------------------------|
| **5V Power**         | 2      | ‚Äî   | Shared with CO‚ÇÇ sensor, DAC (0‚Äì10V) |
| **GND**              | 6      | ‚Äî   | Shared ground                       |
| **UART RX**          | 10     | 15  | CO‚ÇÇ sensor TX ‚Üí Pi RX               |
| **UART TX**          | 8      | 14  | CO‚ÇÇ sensor RX ‚Üê Pi TX               |
| **Relay: Light**     | 16     | 23  | Digital Output                      |
| **Relay: 12V Bus**   | 32     | 12  | Digital Output                      |
| **I¬≤C Multiplexer SCL** | 5   | 3   | I¬≤C Clock Line                      |
| **I¬≤C Multiplexer SDA** | 3   | 2   | I¬≤C Data Line                       |

üß™ I¬≤C Devices

| Device        | Address | Description              |
|---------------|---------|--------------------------|
| I¬≤C Hub       | 0x70    | TCA9548A Multiplexer     |
| I¬≤C ADC       | 0x18    | MS51 Analog Input (pump/valves) |
| 0‚Äì10V DAC     | 0x58    | DFR0971 Light Dimming    |
| Temp Sensor 1 | 0x76    | BME280 ‚Äì Canopy Sensor   |
| Temp Sensor 2 | 0x77    | BME280 ‚Äì Substrate Sensor|





i2c hub


    SDA SCL SDA SCL  SDA SCL SDA SCL
    7   7   6   6    5   5   4   4
    |   |   |   |    |   |   |   |
----+   +   +   +----+   +   +   +-- -SCL
                                     -SDA
                                     -VCC
----+   +   +   +----+   +   +   +-- -GND
    |   |   |   |    |   |   |   |
    3   3   2   2    1   1   0   0
    SDA SCL SDA SCL  SDA SCL SDA SCL

i2c ADC

i2c DAC




üìü ADC to Relay Mapping (via MS51)

| ADC Pin | Relay Channel |
|---------|----------------|
| 7       | Relay 1        |
| 8       | Relay 2        |
| 9       | Relay 3        |
| 10      | Relay 4        |
| 11      | Relay 5        |
| 12      | Relay 6        |
| 13      | Relay 7        |
| 14      | Relay 8        |

‚ö†Ô∏è Notes

- All I¬≤C and analog devices must share a **common GND** with the Raspberry Pi.
- DAC outputs are 0‚Äì10V analog and must be referenced to Pi GND for correct voltage swing.
- CO‚ÇÇ sensor (MH-Z19) communicates via **UART** and requires 5V power.
- Relay boards controlled by either GPIO or the MS51 microcontroller (via I¬≤C).
- For reliable I¬≤C operation, cables should be short and shielded where possible.






